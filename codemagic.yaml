# Check out https://docs.codemagic.io/getting-started/building-a-native-android-app/ for more information

workflows:
  android-app:
    name: Android App
    environment:
      vars:
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmZ0UzZmXzg3NzdldnNTOVpVVDhfVFh1cGZoOUdCQzlMcEdJX1o4SVlkeXpTOHJvM1VnSlVXa3ljVmxOYWMxTTFJVXJCVExwOEhIYWVYdVV0YVV5Yk44dzRBSC1vMUQxQnpCYjlJbG1VSE5kUFZjaml0c0tSMGRiUnItTEpkQVdWYUJwS2lvMjdMYzMyZDJJdWw5cnRUZHdGWHpJTllpQmlMbmxoUm9OZmw0ZEFMUGs5NGJyeWpEcEpxeWp3akotYkNwOUZnUFcxTjY0eHBrX2VPdHdiZk94RDBscEhwdmFMTHZHLTA0Y0p5ckg1RHpOdUxKREREallrS0FBR3drelRaX1RldVV3NlNjaXdjTUtKbUNyeVdMemFmRGpaaHRIa2VlaGdxSU1KekVpSVJZZ192YmxpUThzTHhheS05TjNFeXJOZVZQQmJfdDBLaWE2SXVYWm1SU3J2LXNhQkNuTERQWTJtT1RSQ2VPVE9mV0tzWTVvaHNmQmx6RzFyaGYyLUJVSXhGNF9hbmotTkxVZlYzbC1xRlQySWY1N1VBSVhPZE1JZVAxTXlYcWZxUVp3R3dsSWNydjFjSzd5TjZVVEtwN3oweEw0al9OMmRQUm13cDVqZTQ3RzgyZjNkMkM4Zzc1bXlTd0dkbllCc3JTMk04N0VXOVdzdmVaZ1E2eVBqYnBjRFNycFFnb1M1eEpWQ0dmNWRhZW82Q201dGxqRmtxTl82Ym15bXgwbnh3bmJTZERYbHprTUJGczB1Yk9sMTVvbFEteUxHLTVJa09yOENrNlpzZjdqQ3ZvVEtNR2RYQUIzd2trZHZJUzlYaDJoaWZ0WkI3THRpdVVIRWJnSWlRanQ4bTlWU0JNYjNTRkRQUlNlT0Q5MUpNVVRvYU9TSk50VnNuM091ZkZNVEFpcFN0cmU3QllSZ3VLQU13OHctYWRsVzZ0OHA0NXByZlA3MzlNb1poS2MtMkNOWHdibllDZDVwRS1DdFZZVDA1N28xTmFQYjR1aE9sbjNMNDV3ek9yN0ZJcWhyUVBtWC1UNTRpMG9MOUU0UGk5WTRwMEVYdFhDemZQcV9ETjhLYjNveDVsdjFaN2xMVHFhbGFjaVJvdTJQckU0TGRfQzhTaHlaZ2tTaks1ekpqbXRzWnkzVW00YnZkV0lUc21FRWduSTIxUnR4UE5mNldHSi1BMTdSTkFFMldJVDlGZThSS2RwbTdJcndwM2lMN1Q3RVJNWDBPX0dPdW5qLXBlSlh0bWJTVnZwQ2hHVHpEb2NHanc2a212U0NNYjQ1VDJCbDdVU0IzYXlMNW1sN3Ytek9CWXhfUnl2aU00THM0ZjJhYUwxbUhuWE42LVByWDlsLWRSZDlZOUw2N1VRM3JyWUFrcDdhSVNxaUZzZzhOR0t2cF9vdnlNUmhKV1lDanJCS091eWlOci1fZllDMHUxcGxBMWJka0VsV0pFTVBKeV9WWEQzakpJZDg3NmFxRl9QemxhWmRTMW1jY0FzZ25YYW5JVzhON0lFYUVaWmRUeER5WHVUU2J4RGhwRkx6ZjZaUXl5R3BWWXV2aTVDamJzWlE4c0p6VUhaa2dHOVhXNHQ1Z2lucHlvVjhqNTctNTFSV01Yem0xVjZ1UHhIWldIMTNwT0J5dXUzc0FSSWFBOHo0a0w2RGdRRlA1T3dYMkg1OGY2UnBiWUxqVHVwMzcyT3l1VlM2U3hiQVoyNEFXdGNaU2RmZUpiRTZOVjdWS0wxTEpqOTVVZktKUzQ4ZURBVTBFR3REb3RnUEZYcWNBbGJFM244Y1FlS3hidHlTQkxkVFVUOXE4TXBzZmNocE83UjV1YUlxTzJtMFFLbEFfTXJBSFhDWWNXSHFJSXpDbVNRSDU4Y2R2Szh4MGdBaGJsQXdtZnhXV3RwMmk2ZDBhN0hoaEZDT0U5WmN5WTZSYUpsN3JFQkl3bm5pck5fU21BNFdaNWw1enFnRjk0Qy1TWTcxNzdSdXd4bVM3R2hoaUtIbGFINkFfTjJCMGczN0VXM0U4U2pqbmwtSkNrNXFrZ0dsWmFGTG1pdEw0R2owWDFGU0ptS3ItZ21xczVFS3ZJbV8wbDJLeTdRcGdOdl92eE4tMzUzVFN4UnB0Ul93RElqNHR0d183cXN3ZHplRGlpLUVlZnB6Tld0OTNVb3FISVg3UG14ck13U3JxUTFYWW1rWmxwWVZpN1NqMlJnelBBYmZQbWhjenlCd3ZLY2NNQi04OXZXSUdGM0NrbVJ1cUExWkh4dk1iMU9jbzhybHhUUUczNjdoWVN6MEVUckczaGFqQkRtU2RyeGxTVHRpS0t6VFNMaEkxNEVEMFdBLXpJOXFiMy1kclpuRE5nejVIQ0ZvVUc2djM1bTdvZzdQSno5S0VDeFdGTkphSFg1MmRhOV8wZFByc0pVbHc0a2V6YU16QVIzc0VuTXBNUDRpRVRXSG4xYy1SQks5VDdzOHoyS0p1TUQ0a1p5TjdSQWloR254OU9iUWlFQV9yeWFaWkVTaUhPYnhlN213Y1l6OFF3NTNNQ3VLOVljaVVvNnFZb1h3dlJNU0htOWdyUUp2aGVaZ0I3a1VBTHpGMFVvZFcwd2ZxbmRON280ZmVyU1JDX3ZSSHlRNDZ0OEFCb2hsNHpYNkdWbk1CWWtFaVpXdjFPLW5rcHJXWU9iOWRTN05zcHh4SWRHVHFuRzhEWVk3cHEyekVuUk1TZ3ZIdHVKMWlYRFF4dm1XX1hRaW55enh5Z0hWZHI3emlYb0JOUktmVzBhbXFiV2ZSczY1elY1LU5IdXExUktxUkxiTlRUZE90ajZNeURsREpvRFNNRDhJWDVzNHdKUEd5Y196ajNwdHA3SkM2cERvczlpU1lFMWt6Zl9LeS1sTmVRdGc2OURnb0xENWFWUTVnZ3NzR2tHNUdTb3JyZl9EaEs1MUlVRE43UEdEMGRVUDNwRFIyWmR6b1d4eDM0ekJJYkI3U04wUHZRMGFUbDlkdXFQRGw0MUVSUnYzSTFpcnlJQlk3OV9sTGQ5ejBSXzdlZjdyX0pqYnFSclFFLTY3a3VjcDZjQWJCajZFRU4wQzNxTzZndnRmTlItVGZTR210dTlOVW5DeFZvcjFQV1l1STBjb1dseExNZkt3NndKb3NDZU1WOXYtOGM3OFBHdnBaU2dqTl9qam5NeFhNWVVjcGM3dEhYZHI5SGRJUHZDLUF0dG1RZFhzMFNyenZkOWRmTEZDMnUta1RkR1g1ZnltSlMxZjNMTXEzSzRyOTctTEhkMFRkOGxTUmlTMmR5ZXhTOG1fdEhSaWpDQWdqbEVxYzJOUE5VVWJpOW5RcDMta1VJNENYTFJZTVhsTF94aWlpSGxnSnN1Mk5QSlhaaHFwZzZ0akRwbWpheThhZmx3Zy1xamk5SjA2ZmExMThXeTVRZVNodGNpdXE1MzVnVDRFV21IakxFbDVzak9YTXQwaGhpaVBhZ0tBcElINHh3eGdjdWt1bmtzcm13amlEa3VNel9FV2ZBd1UzUkNTQmdVaG4zOEN6QmJHWTBoMnBMQWJfLUhEOGxpRVNXUFF5anF2cHh0QU8ydVNTdC1feGI2QVJhT01fRjN0RDVtOTM5MGRUdXZMRWRCQ0ZLRnRLZkVEQWtmbGd0LTAtWW1NREJOcXJmdXhtZWxTT2VfQ1l2Nk1kTEFSOHhNcFhXTF9OaTlBOGk3Q0YyejRDVlEzSlpMTkZRZ294Mks1a1F4WlNuVmVRVVhXekd5LWdDN2pYNkVGc3UzcUd2ZlZ2MmVUdVJfM3NZTmxuMmtEWTUtQUx2R2c4c1Nvd0tGVkNlbXR5U0pCRW9GMkItZVdsUng0enlIdWlIVzFaRnNhbEMtVGQ3T2ZOZDZwNDE0RHRpZGozVE9Kc3lPM3BSYTlGRXE0d09PV0JQV0hzRnpXVUJJejBTOUVHRFBvRFY3dTNTRVZNMFQyYU5aOW5fbjB6ZlZqSXFVUDBhX1dUZkR6OFlnN3Jhb0xpX2tBVVRLQ3FXZWZnclluZmMxS1lVZkJ6MmZvc01SLTYydzd6YTgxTzdBQkg2dmVGSVNRVDBEU2tacDFpZHJrRHNhY0JUNk9FSUJCNkRGTlA0UHhfWklhRzhXdUR2R0x0cjduV1pwbjhmYjBwTWczTkZjRHJ6YU43SGs3MVEwNGdncUNvTG5teTV3OUZSc3pucm41Mi1RQ1ZCUmM1NmFtSFhtajBmQnduUnRpaEppLTAxZGl1dlBrVWNUV2N3RWNsZ2tjRjZQU0E2akNoeWQ3TDdzYWU4c1J6NV9ldGdaQVZBT1hBVkVyRVRrRTBVM1h2U2Q2QWV3TjNtVHp0Njhlc2VkTzV5WmtjbWpXY211bEgtZXNPN2V3MHotWXZySlJsRndKUVcta081TzlTQnR2dE1pM2w3QTd1SXlJZ3FhNEJObHJ4VV9qSzNBT19iTU9RZ0Z5WWp3Y1ZJcE42MFhPQW5RS19EZE1oSDZQYjRfODZnOXYwNS10VDRuS2hzNXFJWlVUdzNDTG1Ob3dDMFREaFNLYldpTVRnMFB1dGRTbTF4clhnT1N4NG5pWWpDV0dSUFZrQUdOUl9Ob2ZnbEhNT18tX3hROWxDdzdVQlJ5c0UwTVYwLU1mSUwtYmNBdi1GU2V5ZVNmc2hmeU1wUDRtbmlZZUxBdGFMUmkydFBnblBHYkw5aWpCUFZYWTNTcURiR2xIYzZzUTRxcTU5b01iMXJCel9OZml3LWEyYWlYM2lyWTVoN1U1MHFXZHFVMW5JUlRoZVc1cDdpX3kzblctSW5lTjZodUFSamllaEdYbTBSamdVTTVEYWg3TWIwcmNNVnFMTmlGTE9la2t2MVY5cGJVYllKVm1QeEExdUNGM3ppRV9ob0pzRUFtMVkzZUlUMHhiSnZUTi0ycVVxWFhPVDd2LWNOb2liQXdfa1cwTHFkVmdGc1BXd0ZheE9NUUJhUEFJWDBTaDVMRHY3a1AtbUtoanFHNklRemc9PQ==) # PUT THE ENCRYPTED KEYSTORE FILE HERE
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmZ0UzU0RWVuamdoV0dQQTdKT0F3cEV3aHh2Yk1VQVpUcExBZlBKaTBqajBDUlhJNmhzeDJrZlpOTmRRZkRfd2xfYUF4NW1XbDNLenEtbGo3d0dvYi00Z3lndFE9PQ==) # PUT THE ENCRYPTED PASSWORD FOR THE KEYSTORE FILE HERE
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmZ0UzU0RWVuamdoV0dQQTdKT0F3cEV3aHh2Yk1VQVpUcExBZlBKaTBqajBDUlhJNmhzeDJrZlpOTmRRZkRfd2xfYUF4NW1XbDNLenEtbGo3d0dvYi00Z3lndFE9PQ==) # PUT THE ENCRYPTED KEYSTORE ALIAS PASSWORD HERE
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmZ0UzVjY0RVY2NXTGEydGpMLVdXSTJxUmNSSEhHUU5PQVhCdF9jV2VfZUpydXg2R0lKMXg2WXR5VWJ6WWdLTUtSSWcydEgwZHVPRnp5SGVjc0hfMlNhUDRUaHc9PQ==) #PUT THE ENCRYPTED KEYSTORE USERNAME HERE
      ndk: r21d
    scripts:
      - name: Set up local properties
        script: echo "sdk.dir=$HOME/programs/android-sdk-macosx" > "$FCI_BUILD_DIR/local.properties"
      - name: Set up key.properties file for code signing
        script: |
          echo $FCI_KEYSTORE | base64 --decode > /tmp/keystore.keystore
          cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
          storePassword=$FCI_KEYSTORE_PASSWORD
          keyPassword=$FCI_KEY_PASSWORD
          keyAlias=$FCI_KEY_ALIAS
          storeFile=/tmp/keystore.keystore
          EOF
      - name: Build Android app
        script: ./gradlew assembleRelease
    artifacts:
      - app/build/outputs/**/*.apk
    publishing:
      github_releases:
        prerelease: false
        artifact_patterns:
          - app-release.apk
          - '*.aab'
      email:
        recipients:
          - nicoeevee@gmail.com
        notify:
          success: false     # To not receive a notification when a build succeeds
          failure: false     # To not receive a notification when a build fails

